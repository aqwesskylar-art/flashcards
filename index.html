<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>Flashcards</title>
<style>
  body {
    margin: 0;
    padding: 0;
    height: 100vh;
    display: flex;
    flex-direction: column;
    background: #f5f5f5;
    font-family: sans-serif;
    align-items: center;
  }
  #card {
    width: 90%;
    flex: 1;
    max-width: 500px;
    background: white;
    border-radius: 16px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    margin-top: 20px;
    margin-bottom: 20px;
    padding: 20px;
    text-align: center;
    font-size: 24px;
    transition: transform 0.25s;
  }
  #card img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
  }
  button {
    padding: 14px 22px;
    margin: 6px;
    border: none;
    border-radius: 10px;
    background: #007bff;
    color: white;
    font-size: 18px;
  }
  #deleteButton {
    background: #e74c3c;
  }
  #addCardForm {
    display: none;
    flex-direction: column;
    background: white;
    padding: 20px;
    border-radius: 16px;
    width: 90%;
    max-width: 500px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    margin-top: 20px;
  }
  input, textarea {
    margin: 8px 0;
    padding: 10px;
    width: 100%;
    border-radius: 6px;
    border: 1px solid #ccc;
  }
</style>
</head>
<body>

<div id="card">
  <p id="text"></p>
  <img id="image" src="" style="display:none;">
</div>

<button type="button" onclick="toggleAddForm()">Add Card</button>
<button type="button" id="deleteButton" onclick="deleteCard()">Delete</button>
<button type="button" onclick="exportCards()">Export Cards</button>
<input type="file" id="importFile" style="display:none;" accept=".json" onchange="importCards(event)">
<button type="button" onclick="document.getElementById('importFile').click()">Import Cards</button>

<div id="addCardForm">
  <h3>Add New Card</h3>
  <label>Front (Text):</label>
  <textarea id="frontTextInput" rows="3"></textarea>
  <label>Back (Image):</label>
  <input type="file" accept="image/*" id="backImageInput">
  <button type="button" onclick="addCard()">Save Card</button>
</div>

<script>
// --- Preloaded cards ---
let cards = [
  {
    front: "What is the capital of France?",
    back: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUA..."
  },
  {
    front: "Who painted the Mona Lisa?",
    back: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUA..."
  }
];

let index = 0;
let flipped = false;

// --- Render card ---
function render() {
  const textEl = document.getElementById("text");
  const imgEl = document.getElementById("image");

  if(cards.length === 0){
    textEl.innerText = "No cards yet. Add one!";
    textEl.style.display = "block";
    imgEl.style.display = "none";
    return;
  }

  const card = cards[index];
  if(!flipped){
    textEl.innerText = card.front;
    textEl.style.display = "block";
    imgEl.style.display = "none";
  } else {
    imgEl.src = card.back;
    imgEl.style.display = "block";
    textEl.style.display = "none";
  }
}

// --- Add card ---
function addCard() {
  const frontText = document.getElementById("frontTextInput").value.trim();
  const backFile = document.getElementById("backImageInput").files[0];
  if(!frontText || !backFile){
    alert("Please enter text and select an image");
    return;
  }

  const reader = new FileReader();
  reader.onload = function() {
    cards.push({ front: frontText, back: reader.result });
    index = cards.length - 1;
    flipped = false;
    render();
    document.getElementById("frontTextInput").value = "";
    document.getElementById("backImageInput").value = "";
    toggleAddForm();
  }
  reader.readAsDataURL(backFile);
}

// --- Delete card ---
function deleteCard() {
  if(cards.length === 0) return;
  if(!confirm("Delete this card?")) return;
  cards.splice(index,1);
  if(index >= cards.length) index = cards.length-1;
  flipped = false;
  render();
}

// --- Toggle add card form ---
function toggleAddForm() {
  const el = document.getElementById("addCardForm");
  el.style.display = el.style.display === "flex" ? "none" : "flex";
}

// --- Tap to flip ---
document.getElementById("card").addEventListener("click", () => {
  if(cards.length === 0) return;
  flipped = !flipped;
  render();
});

// --- Swipe navigation ---
let startX = 0;
document.getElementById("card").addEventListener("touchstart", e => { startX = e.touches[0].clientX; });
document.getElementById("card").addEventListener("touchend", e => {
  const endX = e.changedTouches[0].clientX;
  const diff = endX - startX;
  if(Math.abs(diff) > 50){
    if(diff < 0) index = (index +1) % cards.length;
    else index = (index -1 + cards.length) % cards.length;
    flipped = false;
    render();
  }
});

// --- Export cards to JSON ---
function exportCards() {
  const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(cards));
  const dlAnchor = document.createElement('a');
  dlAnchor.setAttribute("href", dataStr);
  dlAnchor.setAttribute("download", "flashcards.json");
  dlAnchor.click();
}

// --- Import cards from JSON ---
function importCards(event){
  const file = event.target.files[0];
  if(!file) return;

  const reader = new FileReader();
  reader.onload = function(e){
    try{
      const imported = JSON.parse(e.target.result);
      if(Array.isArray(imported)){
        cards = imported;
        index = 0;
        flipped = false;
        render();
        alert("Flashcard set loaded!");
      } else {
        alert("Invalid JSON file");
      }
    } catch(err){
      alert("Error reading JSON file");
    }
  }
  reader.readAsText(file);
}

// --- Initial render ---
render();
</script>

</body>
</html>
